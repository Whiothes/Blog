"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[8720],{78264:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>t,contentTitle:()=>d,default:()=>c,frontMatter:()=>s,metadata:()=>r,toc:()=>o});var r=n(7555),l=n(74848),a=n(28453);const s={title:"Switch Back From NVIDIA to Nouveau",tags:["nvidia","nouveau","linux"]},d="Switch back from nvidia to nouveau",t={authorsImageUrls:[]},o=[{value:"disable nvidia driver",id:"disable-nvidia-driver",level:2},{value:"uninstall nvidia driver",id:"uninstall-nvidia-driver",level:2},{value:"reinstall the nouveau driver",id:"reinstall-the-nouveau-driver",level:2},{value:"update the initramfs",id:"update-the-initramfs",level:2},{value:"reconfigure xorg",id:"reconfigure-xorg",level:2},{value:"enable nouveau driver",id:"enable-nouveau-driver",level:2},{value:"switch back to graphical mode",id:"switch-back-to-graphical-mode",level:2},{value:"verify the nouveau driver",id:"verify-the-nouveau-driver",level:2},{value:"resolve the issue",id:"resolve-the-issue",level:2},{value:"stop the display manager",id:"stop-the-display-manager",level:3},{value:"kill processes using the nvidia driver",id:"kill-processes-using-the-nvidia-driver",level:3},{value:"unload the nvidia driver",id:"unload-the-nvidia-driver",level:3},{value:"blacklist the nvidia driver",id:"blacklist-the-nvidia-driver",level:3}];function u(e){const i={code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(i.h2,{id:"disable-nvidia-driver",children:"disable nvidia driver"}),"\n",(0,l.jsxs)(i.ol,{children:["\n",(0,l.jsx)(i.li,{children:"open terminal"}),"\n",(0,l.jsx)(i.li,{children:"check the current driver"}),"\n"]}),"\n",(0,l.jsx)(i.pre,{children:(0,l.jsx)(i.code,{className:"language-sh",children:'lspci -k | grep -A 2 -E "(VGA|3D)"\n'})}),"\n",(0,l.jsx)(i.p,{children:"see the output like this:"}),"\n",(0,l.jsx)(i.p,{children:"Kernel driver in use: nvidia"}),"\n",(0,l.jsxs)(i.ol,{start:"3",children:["\n",(0,l.jsx)(i.li,{children:"switch to text mode"}),"\n"]}),"\n",(0,l.jsx)(i.pre,{children:(0,l.jsx)(i.code,{className:"language-sh",children:"sudo systemctl set-default multi-user.target\nsudo reboot\n"})}),"\n",(0,l.jsxs)(i.ol,{start:"4",children:["\n",(0,l.jsx)(i.li,{children:"remove nvidia driver one by one"}),"\n"]}),"\n",(0,l.jsx)(i.pre,{children:(0,l.jsx)(i.code,{className:"language-sh",children:"sudo modprobe -r nvidia*\n"})}),"\n",(0,l.jsx)(i.h2,{id:"uninstall-nvidia-driver",children:"uninstall nvidia driver"}),"\n",(0,l.jsx)(i.pre,{children:(0,l.jsx)(i.code,{className:"language-sh",children:"sudo apt remove --purge '^nvidia-.*'\nsudo apt autoremove\nsudo apt clean\n"})}),"\n",(0,l.jsx)(i.p,{children:"or if you installed nvidia driver from the official website, you can uninstall it by running the installer again and select uninstall."}),"\n",(0,l.jsx)(i.pre,{children:(0,l.jsx)(i.code,{className:"language-sh",children:"sudo ./NVIDIA-Linux-x86_64-xxx.xx.run --uninstall\n"})}),"\n",(0,l.jsx)(i.h2,{id:"reinstall-the-nouveau-driver",children:"reinstall the nouveau driver"}),"\n",(0,l.jsx)(i.pre,{children:(0,l.jsx)(i.code,{className:"language-sh",children:"sudo apt install xserver-xorg-video-nouveau\n"})}),"\n",(0,l.jsx)(i.h2,{id:"update-the-initramfs",children:"update the initramfs"}),"\n",(0,l.jsx)(i.pre,{children:(0,l.jsx)(i.code,{className:"language-sh",children:"sudo update-initramfs -u\n"})}),"\n",(0,l.jsx)(i.h2,{id:"reconfigure-xorg",children:"reconfigure xorg"}),"\n",(0,l.jsx)(i.pre,{children:(0,l.jsx)(i.code,{className:"language-sh",children:"sudo rm /etc/X11/xorg.conf*\n"})}),"\n",(0,l.jsx)(i.h2,{id:"enable-nouveau-driver",children:"enable nouveau driver"}),"\n",(0,l.jsx)(i.pre,{children:(0,l.jsx)(i.code,{className:"language-sh",children:"sudo rm /etc/modprobe.d/blacklist-nouveau.conf\n"})}),"\n",(0,l.jsx)(i.h2,{id:"switch-back-to-graphical-mode",children:"switch back to graphical mode"}),"\n",(0,l.jsx)(i.pre,{children:(0,l.jsx)(i.code,{className:"language-sh",children:"sudo systemctl set-default graphical.target\nsudo reboot\n"})}),"\n",(0,l.jsx)(i.h2,{id:"verify-the-nouveau-driver",children:"verify the nouveau driver"}),"\n",(0,l.jsx)(i.pre,{children:(0,l.jsx)(i.code,{className:"language-sh",children:'lspci -k | grep -A 2 -E "(VGA|3D)"\n'})}),"\n",(0,l.jsx)(i.p,{children:"see if the output like this:"}),"\n",(0,l.jsx)(i.p,{children:"Kernel driver in use: nouveau"}),"\n",(0,l.jsx)(i.h2,{id:"resolve-the-issue",children:"resolve the issue"}),"\n",(0,l.jsx)(i.p,{children:"modprobe: FATAL: module nvidia is in use"}),"\n",(0,l.jsx)(i.h3,{id:"stop-the-display-manager",children:"stop the display manager"}),"\n",(0,l.jsx)(i.pre,{children:(0,l.jsx)(i.code,{className:"language-sh",children:"sudo systemctl stop gdm/kdm/lightdm\n"})}),"\n",(0,l.jsx)(i.h3,{id:"kill-processes-using-the-nvidia-driver",children:"kill processes using the nvidia driver"}),"\n",(0,l.jsx)(i.pre,{children:(0,l.jsx)(i.code,{className:"language-sh",children:"sudo fuser -k /dev/nvidia*\n"})}),"\n",(0,l.jsx)(i.h3,{id:"unload-the-nvidia-driver",children:"unload the nvidia driver"}),"\n",(0,l.jsx)(i.pre,{children:(0,l.jsx)(i.code,{className:"language-sh",children:"sudo modprobe -r nvidia_drm nvidia_modeset nvidia_uvm nvidia\n"})}),"\n",(0,l.jsx)(i.h3,{id:"blacklist-the-nvidia-driver",children:"blacklist the nvidia driver"}),"\n",(0,l.jsx)(i.pre,{children:(0,l.jsx)(i.code,{className:"language-sh",children:'echo "blacklist nvidia" | sudo tee /etc/modprobe.d/blacklist-nvidia.conf\nsudo update-initramfs -u\n'})})]})}function c(e={}){const{wrapper:i}={...(0,a.R)(),...e.components};return i?(0,l.jsx)(i,{...e,children:(0,l.jsx)(u,{...e})}):u(e)}},28453:(e,i,n)=>{n.d(i,{R:()=>s,x:()=>d});var r=n(96540);const l={},a=r.createContext(l);function s(e){const i=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function d(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:s(e.components),r.createElement(a.Provider,{value:i},e.children)}},7555:e=>{e.exports=JSON.parse('{"permalink":"/blog/2025/01/10/uninstall-nvidia","source":"@site/blog/2025/01-10-uninstall-nvidia.md","title":"Switch Back From NVIDIA to Nouveau","description":"disable nvidia driver","date":"2025-01-10T00:00:00.000Z","tags":[{"inline":true,"label":"nvidia","permalink":"/blog/tags/nvidia"},{"inline":true,"label":"nouveau","permalink":"/blog/tags/nouveau"},{"inline":true,"label":"linux","permalink":"/blog/tags/linux"}],"readingTime":1.24,"hasTruncateMarker":true,"authors":[],"frontMatter":{"title":"Switch Back From NVIDIA to Nouveau","tags":["nvidia","nouveau","linux"]},"unlisted":false,"nextItem":{"title":"How to Find and Replace Project-wide in Vim","permalink":"/blog/2024/12/10/vim-multi-replace"}}')}}]);