"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[3151],{99631:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>c,frontMatter:()=>s,metadata:()=>a,toc:()=>d});var r=t(74848),i=t(28453);const s={},o="KVM \u8fd0\u884c\u5e76\u7f16\u8f91iso\u955c\u50cf\u6587\u4ef6",a={permalink:"/blog/2024/07/25/kvm",source:"@site/blog/2024/07-25-kvm.md",title:"KVM \u8fd0\u884c\u5e76\u7f16\u8f91iso\u955c\u50cf\u6587\u4ef6",description:"\u5b89\u88c5 KVM \u4f9d\u8d56\u5305",date:"2024-07-25T00:00:00.000Z",tags:[],readingTime:1.845,hasTruncateMarker:!0,authors:[],frontMatter:{},unlisted:!1,nextItem:{title:"Reduce Ubuntu Server",permalink:"/blog/2024/06/25/reduce-ubuntu-server"}},l={authorsImageUrls:[]},d=[{value:"\u5b89\u88c5 KVM \u4f9d\u8d56\u5305",id:"\u5b89\u88c5-kvm-\u4f9d\u8d56\u5305",level:2},{value:"\u68c0\u67e5 KVM \u53ef\u7528\u6027",id:"\u68c0\u67e5-kvm-\u53ef\u7528\u6027",level:2},{value:"\u8fd0\u884c Ubuntu \u7528\u4f8b",id:"\u8fd0\u884c-ubuntu-\u7528\u4f8b",level:2},{value:"\u51c6\u5907\u5de5\u4f5c",id:"\u51c6\u5907\u5de5\u4f5c",level:3},{value:"\u521b\u5efa\u955c\u50cf\u6587\u4ef6",id:"\u521b\u5efa\u955c\u50cf\u6587\u4ef6",level:4},{value:"\u914d\u7f6e\u9ed8\u8ba4\u9879",id:"\u914d\u7f6e\u9ed8\u8ba4\u9879",level:4},{value:"\u65b0\u589e\u914d\u7f6e\u6587\u4ef6",id:"\u65b0\u589e\u914d\u7f6e\u6587\u4ef6",level:5},{value:"\u4e3a\u914d\u7f6e\u6587\u4ef6\u63d0\u4f9bhttp\u4e0b\u8f7d\u670d\u52a1",id:"\u4e3a\u914d\u7f6e\u6587\u4ef6\u63d0\u4f9bhttp\u4e0b\u8f7d\u670d\u52a1",level:5},{value:"\u8fd0\u884c\u7528\u4f8b",id:"\u8fd0\u884c\u7528\u4f8b",level:3},{value:"\u5220\u9664\u7528\u4f8b",id:"\u5220\u9664\u7528\u4f8b",level:2},{value:"\u5f15\u7528",id:"\u5f15\u7528",level:2}];function u(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",h5:"h5",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"\u5b89\u88c5-kvm-\u4f9d\u8d56\u5305",children:"\u5b89\u88c5 KVM \u4f9d\u8d56\u5305"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ssh",children:"sudo apt -y install bridge-utils cpu-checker libvirt-clients libvirt-daemon qemu qemu-kvm\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u68c0\u67e5-kvm-\u53ef\u7528\u6027",children:"\u68c0\u67e5 KVM \u53ef\u7528\u6027"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"kvm-ok\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u8fd0\u884c-ubuntu-\u7528\u4f8b",children:"\u8fd0\u884c Ubuntu \u7528\u4f8b"}),"\n",(0,r.jsx)(n.h3,{id:"\u51c6\u5907\u5de5\u4f5c",children:"\u51c6\u5907\u5de5\u4f5c"}),"\n",(0,r.jsx)(n.h4,{id:"\u521b\u5efa\u955c\u50cf\u6587\u4ef6",children:"\u521b\u5efa\u955c\u50cf\u6587\u4ef6"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"qemu-img create -f qcow2 ubuntu-guest.img 3G\n"})}),"\n",(0,r.jsx)(n.h4,{id:"\u914d\u7f6e\u9ed8\u8ba4\u9879",children:"\u914d\u7f6e\u9ed8\u8ba4\u9879"}),"\n",(0,r.jsx)(n.h5,{id:"\u65b0\u589e\u914d\u7f6e\u6587\u4ef6",children:"\u65b0\u589e\u914d\u7f6e\u6587\u4ef6"}),"\n",(0,r.jsxs)(n.p,{children:["\u5728",(0,r.jsx)(n.code,{children:"http/preseed.cfg"}),"\u4e2d\u4e3aubuntu\u793a\u4f8b\u4f7f\u7528\u4ee5\u4e0b\u914d\u7f6e\u9879"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-conf",children:"# Locale settings\nd-i debian-installer/locale string en_US\n\n# Keyboard settings\nd-i console-setup/ask_detect boolean false\nd-i console-setup/layoutcode string us\nd-i keyboard-configuration/xkb-keymap select us\n\n# Network settings\nd-i netcfg/choose_interface select auto\nd-i netcfg/get_hostname string LongPark\nd-i netcfg/get_domain string unassigned-domain\nd-i netcfg/disable_dhcp boolean false\nd-i netcfg/dhcp_failed note\nd-i netcfg/dhcp_options select Configure network manually\n\n# Mirror settings\nd-i mirror/country string manual\nd-i mirror/http/hostname string archive.ubuntu.com\nd-i mirror/http/directory string /ubuntu\nd-i mirror/http/proxy string\n\n# Clock and time zone settings\nd-i clock-setup/utc boolean true\nd-i time/zone string US/Eastern\nd-i clock-setup/ntp boolean true\n\n# Partitioning settings\nd-i partman-auto/method string regular\nd-i partman-lvm/device_remove_lvm boolean true\nd-i partman-md/device_remove_md boolean true\nd-i partman-auto/choose_recipe select atomic\nd-i partman/confirm_write_new_label boolean true\nd-i partman/confirm boolean true\nd-i partman/confirm_nooverwrite boolean true\n\n# User setup\nd-i passwd/root-login boolean false\nd-i passwd/make-user boolean true\nd-i passwd/user-fullname string LongPark User\nd-i passwd/username string longpark\nd-i passwd/user-password password longpark\nd-i passwd/user-password-again password longpark\nd-i user-setup/allow-password-weak boolean true\nd-i user-setup/encrypt-home boolean false\n\n# Package selection\nd-i pkgsel/include string openssh-server\nd-i pkgsel/upgrade select none\n\n# Boot loader settings\nd-i grub-installer/only_debian boolean true\nd-i grub-installer/with_other_os boolean true\n\n# Finishing up the installation\nd-i finish-install/reboot_in_progress note\nd-i debian-installer/exit/reboot boolean true\n\n# Late command\nd-i preseed/late_command string wget -O /target/etc/apt/apt.conf.d/99force-ipv4 http://example.com/99force-ipv4; in-target apt-get update\n"})}),"\n",(0,r.jsx)(n.h5,{id:"\u4e3a\u914d\u7f6e\u6587\u4ef6\u63d0\u4f9bhttp\u4e0b\u8f7d\u670d\u52a1",children:"\u4e3a\u914d\u7f6e\u6587\u4ef6\u63d0\u4f9bhttp\u4e0b\u8f7d\u670d\u52a1"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"sudo python3 -m http.server 8000 --directory http\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u8fd0\u884c\u7528\u4f8b",children:"\u8fd0\u884c\u7528\u4f8b"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:'sudo virt-install \\\n  --name ubuntu-guest \\\n  --os-variant ubuntu20.04 \\\n  --vcpus 2 \\\n  --ram 2048 \\\n  --location http://ftp.ubuntu.com/ubuntu/dists/focal/main/installer-amd64/ \\\n  --network bridge=virbr0,model=virtio \\\n  --graphics none \\\n  --disk path=ubuntu-guest.img,format=qcow2 \\\n  --extra-args="console=ttyS0,115200n8 serial auto=true priority=critical url=http://${IPADDR}:8000/preseed.cfg"\n'})}),"\n",(0,r.jsx)(n.h2,{id:"\u5220\u9664\u7528\u4f8b",children:"\u5220\u9664\u7528\u4f8b"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"sudo virsh destroy ubuntu-guest\nsudo virsh undefine ubuntu-guest\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u5f15\u7528",children:"\u5f15\u7528"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://ubuntu.com/blog/kvm-hyphervisor",children:"KVM hypervisor: a beginners\u2019 guide | Ubuntu"})}),"\n"]})]})}function c(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>a});var r=t(96540);const i={},s=r.createContext(i);function o(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);